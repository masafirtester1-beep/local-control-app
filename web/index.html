<!doctype html>
<html lang="ar">
<head>
  <meta charset="utf-8" />
  <title>Local Control — واجهة</title>
  <style>
    body{font-family:system-ui,Arial;padding:16px}
    input,button,textarea{padding:8px;margin:6px 0}
    textarea{width:100%;height:220px}
    .row{margin:12px 0}
  </style>
</head>
<body>
  <h2>Local Control — واجهة التحكم</h2>

  <label>API Key (x-api-key): <input id="apikey" type="password" style="width:60%"></label>

  <div class="row">
    <h3>List folder</h3>
    <input id="listdir" placeholder="مثال: ./web" style="width:60%" />
    <button onclick="listDir()">List</button>
  </div>

  <div class="row">
    <h3>System info</h3>
    <button onclick="sysInfo()">Get System Info</button>
  </div>

  <div class="row">
    <h3>Start app (npm start)</h3>
    <input id="startdir" placeholder="مثال: ./ (project root)" style="width:60%" />
    <button onclick="startApp()">Start</button>
  </div>

  <div class="row">
    <h3>Backup folder → ZIP</h3>
    <input id="backupdir" placeholder="مثال: ./web" style="width:60%" />
    <button onclick="backup()">Backup</button>
  </div>

  <h3>Output</h3>
  <textarea id="out" readonly></textarea>

<script>
async function callAPI(path, body){
  const res = await fetch(path, {
    method: 'POST',
    headers: {
      'content-type':'application/json',
      'x-api-key': document.getElementById('apikey').value
    },
    body: JSON.stringify(body||{})
  });
  return res.json();
}
async function listDir(){
  const r = await callAPI('/api/list', { dir: document.getElementById('listdir').value || '.' });
  document.getElementById('out').value = JSON.stringify(r, null, 2);
}
async function sysInfo(){
  const r = await callAPI('/api/sysinfo', {});
  document.getElementById('out').value = JSON.stringify(r, null, 2);
}
async function startApp(){
  const r = await callAPI('/api/start', { dir: document.getElementById('startdir').value || '.' });
  document.getElementById('out').value = JSON.stringify(r, null, 2);
}
async function backup(){
  const r = await callAPI('/api/backup', { dir: document.getElementById('backupdir').value || '.' });
  document.getElementById('out').value = JSON.stringify(r, null, 2);
}
</script>
</body>
</html>
